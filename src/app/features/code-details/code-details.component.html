<div class="code-details-container">
    <div class="header">
        <h2>Code Details</h2>
        <p class="description">Define details - Entry {{ currentEntry + 1 }} of {{ totalEntries }}</p>
    </div>

    <div class="content">
        <div class="card">
            <h3>Detail {{ currentEntry + 1 }} Configuration</h3>

            @if (successMessage) {
            <div class="alert alert-success">{{ successMessage }}</div>
            }

            @if (errorMessage) {
            <div class="alert alert-error">{{ errorMessage }}</div>
            }

            @if (savedCodes.length > 0) {
            <div class="saved-info">
                <strong>Saved:</strong> {{ savedCodes.join(', ') }}
            </div>
            }

            <form [formGroup]="detailForm" (ngSubmit)="onSubmit()" class="form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="code">Code <span class="required">*</span></label>
                        <input id="code" type="text" formControlName="code" placeholder="e.g., XYZ, ABC"
                            [class.invalid]="code?.invalid && code?.touched" />
                        @if (code?.invalid && code?.touched) {
                        <span class="error-text">Code is required (min 2 chars)</span>
                        }
                    </div>

                    <div class="form-group">
                        <label for="sortOrder">Sort Order <span class="required">*</span></label>
                        <input id="sortOrder" type="number" formControlName="sortOrder" readonly
                            class="readonly-input" />
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="nameAr">Name (Arabic) <span class="required">*</span></label>
                        <input id="nameAr" type="text" formControlName="nameAr" placeholder="الاسم بالعربية" dir="rtl"
                            [class.invalid]="nameAr?.invalid && nameAr?.touched" />
                        @if (nameAr?.invalid && nameAr?.touched) {
                        <span class="error-text">Arabic name is required</span>
                        }
                    </div>

                    <div class="form-group">
                        <label for="nameEn">Name (English) <span class="required">*</span></label>
                        <input id="nameEn" type="text" formControlName="nameEn" placeholder="English Name"
                            [class.invalid]="nameEn?.invalid && nameEn?.touched" />
                        @if (nameEn?.invalid && nameEn?.touched) {
                        <span class="error-text">English name is required</span>
                        }
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="descriptionAr">Description (Arabic) <span class="required">*</span></label>
                        <textarea id="descriptionAr" formControlName="descriptionAr" placeholder="الوصف بالعربية"
                            dir="rtl" rows="4"
                            [class.invalid]="descriptionAr?.invalid && descriptionAr?.touched"></textarea>
                        @if (descriptionAr?.invalid && descriptionAr?.touched) {
                        <span class="error-text">Arabic description is required</span>
                        }
                    </div>

                    <div class="form-group">
                        <label for="descriptionEn">Description (English) <span class="required">*</span></label>
                        <textarea id="descriptionEn" formControlName="descriptionEn" placeholder="English Description"
                            rows="4" [class.invalid]="descriptionEn?.invalid && descriptionEn?.touched"></textarea>
                        @if (descriptionEn?.invalid && descriptionEn?.touched) {
                        <span class="error-text">English description is required</span>
                        }
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary" [disabled]="isLoading">
                        @if (isLoading) {
                        <span class="spinner"></span>
                        Saving...
                        } @else if (currentEntry < totalEntries - 1) { Save & Next } @else { Save & Continue } </button>
                </div>
            </form>
        </div>
    </div>
</div>